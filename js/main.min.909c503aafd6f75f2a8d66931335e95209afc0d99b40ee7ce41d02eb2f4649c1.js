const supportViewTransition=document.startViewTransition;supportViewTransition||(document.startViewTransition=e=>e());class Router{constructor(e=null,t=null){if(window.Router)return window.Router;window.Router=this,this.onBeforeNavigate=e,this.onAfterNavigate=t,this.cache={},document.addEventListener("click",this.clickHandler.bind(this)),window.addEventListener("popstate",this.popStateHandler.bind(this))}async clickHandler(e){if(e.button!==0)return;const n=e.target.closest("a");if(!n)return;const t=n.href;if(!t||t.indexOf(location.origin)!==0||e.ctrlKey||e.metaKey)return;if(new URL(t).pathname.replace(/\/$/,"")===location.pathname.replace(/\/$/,"")){e.preventDefault();return}e.preventDefault(),await this.navigate(t)}async navigate(e){history.replaceState({html:document.documentElement.outerHTML,scroll:document.querySelector("#container")?.scrollTop??null},null,location.href),history.pushState(null,null,e),await this.loadHTML(e,document.body.getAttribute("type")??null)}async loadHTML(e,t=null,n=null,s=null){await Promise.all([new Promise(async t=>{n||(n=this.cache[e]),n||(n=await fetch(e).then(e=>e.text())),t()}),transitionPolyfill(e)]),this.cache[e]=n,this.onBeforeNavigate&&this.onBeforeNavigate();const i=new DOMParser,o=i.parseFromString(n,"text/html"),a=document.startViewTransition(()=>{document.title=o.title,o.querySelector("#optionsContainer")?.classList?.remove("open"),document.querySelector("#main").replaceWith(o.querySelector("#main")),document.body.setAttribute("type",o.body.getAttribute("type")),document.body.setAttribute("from",t),document.body.classList.remove("transition-done"),document.querySelector(".nav-sections").setAttribute("data-section",o.querySelector(".nav-sections").getAttribute("data-section")),s!==null&&document.querySelector("#container")&&(document.querySelector("#container").scrollTop=s);const e=document.querySelectorAll("script");for(const t of e)t.src||eval(t.innerHTML);this.onAfterNavigate&&this.onAfterNavigate()});try{await a.finished}catch{}finally{document.body.classList.add("transition-done")}}async popStateHandler(e){e.state?await this.loadHTML(location.href,document.body.getAttribute("type")??null,e.state.html,e.state.scroll):await this.loadHTML(location.href,document.body.getAttribute("type")??null)}static init(e=null,t=null){new Router(e,t)}}function transitionPolyfill(e){if(supportViewTransition)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;const s=new URL(e).pathname.replace(/\/$/,""),t=s.length?"page":"home",n=document.body.getAttribute("type")??null;if(t=="page"&&n=="page"){const e=document.querySelector("#card");if(!e)return;return new Promise(t=>{e.animate([{transform:"translateY(0)",opacity:1},{transform:"translateY(min(60vh, 600px))",opacity:0}],{duration:250,easing:"ease",fill:"both"}).onfinish=t})}if(t=="home"&&n=="page"){const e=document.querySelector("#card");if(!e)return;return new Promise(t=>{e.animate([{transform:"translateY(0)"},{transform:"translateY(calc(100vh + 310px))"}],{duration:350,easing:"ease",fill:"both"}).onfinish=t})}if(t=="page"&&n=="home"){const e=document.querySelector("#buttonWrapper");return new Promise(t=>{e.animate([{transform:"scale(1)",opacity:1},{transform:"scale(0.9)",opacity:0}],{duration:250,easing:"ease",fill:"both"}).onfinish=t})}}class Triangles{equalateralRatio=.8660254037844386;baseVelocity=100;triangleSize=40;spawnRatio=1;baseColor=[241,200,20];constructor(e){this.svg=e;const n=e.getAttribute("viewBox").split(" ").map(Number);return this.width=n[2],this.height=n[3],this.triangleSize=this.height*.4,this.maxCount=Math.round(this.width*this.height/(this.triangleSize*this.triangleSize)*this.spawnRatio*7),this.init(),this}init(){this.svg.innerHTML="",this.addTriangles(!0),window.addEventListener("visibilitychange",this.onVisibilityChange.bind(this)),this.animation=requestAnimationFrame(this.tick.bind(this))}tick(e){this.lastTime||(this.lastTime=e);const t=e-this.lastTime;if(this.lastTime=e,!this.svg){this.destory();return}this.update(t),this.animation=requestAnimationFrame(this.tick.bind(this))}update(e){const t=this.svg.querySelectorAll("polygon"),n=e*1*this.baseVelocity/(this.height/this.triangleSize)/2500;for(const e of t){let s=Number(e.getAttribute("y"));const o=Number(e.getAttribute("scale")),i=Number(e.getAttribute("size"));if(s-=Math.max(.35,o)*n,s<-i/2){e.remove(),this.addTriangle();continue}e.setAttribute("y",s),this.renderTriangle(e)}}addTriangles(e=!1){const t=this.svg.childElementCount;for(let n=0;n<this.maxCount-t;n++)this.addTriangle(e)}addTriangle(e=!1){const o=.16,i=.5,[a,r]=[Math.random(),Math.random()],c=Math.sqrt(-2*Math.log(a))*Math.sin(2*Math.PI*r),s=Math.max(1*(i+o*c),.1),n=this.triangleSize*s,l=this.randomBetween(-n*this.equalateralRatio,this.width+n*this.equalateralRatio),d=e?this.randomBetween(-n/2,this.height+n):this.height+n,u=this.randomShade(),t=document.createElementNS("http://www.w3.org/2000/svg","polygon");t.setAttribute("x",l),t.setAttribute("y",d),t.setAttribute("scale",s),t.setAttribute("size",n),t.setAttribute("fill",u),this.renderTriangle(t),this.svg.appendChild(t)}renderTriangle(e){if(!e)return;const n=Number(e.getAttribute("x")),s=Number(e.getAttribute("y")),t=Number(e.getAttribute("size")),o=n,i=s-t,a=n-t*this.equalateralRatio,r=s+t/2,c=n+t*this.equalateralRatio,l=s+t/2;e.setAttribute("points",`${o},${i} ${a},${r} ${c},${l}`)}destory(){cancelAnimationFrame(this.animation),this.svg=null,window.removeEventListener("visibilitychange",this.onVisibilityChange.bind(this))}randomBetween(e,t){return Math.random()*(t-e)+e}randomShade(){const e=1.025+(Math.random()-.5)*.175,t=this.baseColor.map(t=>Math.round(t*e));return`rgb(${t.join(",")})`}onVisibilityChange(){document.hidden?cancelAnimationFrame(this.animation):(this.lastTime=null,this.animation=requestAnimationFrame(this.tick.bind(this)))}}const initHomeCookieTriangleAnimation=()=>{if(!document.querySelector("#logo .triangles"))return;window.homeCookieTriangleAnimation=new Triangles(document.querySelector("#logo .triangles"))};document.addEventListener("DOMContentLoaded",()=>{initHomeCookieTriangleAnimation()}),Router.init(()=>{window.homeCookieTriangleAnimation?.destory()},()=>{initHomeCookieTriangleAnimation()})